{% assign summary = include.summary | default: page.services_summary | default: 'Consistent finish work, waterproof assemblies, and recurring care that keep rentals, shore homes, and owner-occupied properties in top shape.' %}
{% assign services = include.services | default: page.services | default: site.data.services.services %}

<section class="ts-services" aria-labelledby="ts-services-title">
  <div class="container">
    <header class="ts-services__header">
      <span class="eyebrow text-accent">Core Capabilities</span>
      <h2 id="ts-services-title" class="heading-2 text-primary">Remodels, tile assemblies, and property upkeep</h2>
      <p class="lead">{{ summary }}</p>
    </header>

    <div class="ts-services__grid" role="list">
      {% for raw in services %}
        {%- comment -%}
        Normalize service fields so this works with either:
        - String format: "paint|Title|Description|/url|Tagline|Details"
        - Object format: { "icon": "...", "title": "...", "description": "...", "url": "...", "tagline": "...", "details": "..." }
        {%- endcomment -%}

        {% assign service_tagline = raw.tagline %}
        {% assign service_details = raw.details %}

        {% if raw contains '|' %}
          {% assign parts = raw | split: '|' %}
          {% assign service_icon_key = parts[0] | strip %}
          {% assign service_title = parts[1] | strip %}
          {% assign service_description = parts[2] | strip %}
          {% assign service_url = parts[3] | strip %}
          {% if parts.size > 4 %}
            {% assign service_tagline = parts[4] | strip %}
          {% endif %}
          {% if parts.size > 5 %}
            {% assign service_details = parts[5] | strip %}
          {% endif %}
        {% else %}
          {% assign service_icon_key = raw.icon %}
          {% assign service_title = raw.title %}
          {% assign service_description = raw.description %}
          {% assign service_url = raw.url %}
        {% endif %}

        {%- comment -%}
        Build an inline SVG icon based on service_icon_key.
        Keys expected from your data: paint, flooring, waterproof, maintenance
        {%- endcomment -%}
        {% capture service_icon %}
          {% case service_icon_key %}
          {% when 'paint' %}
            <svg class="ts-service-icon" role="img" aria-hidden="true" viewBox="0 0 32 32">
              <rect x="3" y="6" width="18" height="8" rx="2" ry="2" fill="none" stroke="currentColor" stroke-width="1.7" />
              <rect x="8" y="14" width="8" height="9" rx="2" ry="2" fill="none" stroke="currentColor" stroke-width="1.7" />
              <path d="M8 23v3a3 3 0 0 0 6 0v-3" fill="none" stroke="currentColor" stroke-width="1.7" />
              <path d="M21 6h5a3 3 0 0 1 3 3v3" fill="none" stroke="currentColor" stroke-width="1.7" />
              <path d="M3 12h18" fill="none" stroke="currentColor" stroke-width="1.7" />
            </svg>
          {% when 'flooring' %}
            <svg class="ts-service-icon" role="img" aria-hidden="true" viewBox="0 0 32 32">
              <rect x="4" y="6" width="10" height="10" fill="none" stroke="currentColor" stroke-width="1.7" />
              <rect x="18" y="6" width="10" height="10" fill="none" stroke="currentColor" stroke-width="1.7" />
              <rect x="4" y="18" width="10" height="10" fill="none" stroke="currentColor" stroke-width="1.7" />
              <rect x="18" y="18" width="10" height="10" fill="none" stroke="currentColor" stroke-width="1.7" />
              <path d="M4 16h24M16 6v22" fill="none" stroke="currentColor" stroke-width="1.1" stroke-dasharray="2 2" />
            </svg>
          {% when 'waterproof' %}
            <svg class="ts-service-icon" role="img" aria-hidden="true" viewBox="0 0 32 32">
              <path d="M16 4 C16 4 9 12 9 18a7 7 0 0 0 14 0C23 12 16 4 16 4z" fill="none" stroke="currentColor" stroke-width="1.7" />
              <path d="M13 19a3 3 0 0 0 3 3" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
              <path d="M6 26h20" fill="none" stroke="currentColor" stroke-width="1.3" stroke-linecap="round" />
              <path d="M8 29h16" fill="none" stroke="currentColor" stroke-width="1.1" stroke-linecap="round" />
            </svg>
          {% when 'maintenance' %}
            <svg class="ts-service-icon" role="img" aria-hidden="true" viewBox="0 0 32 32">
              <circle cx="10" cy="10" r="4" fill="none" stroke="currentColor" stroke-width="1.7" />
              <path d="M6 18l-3 8 8-3 6 6 5-5-6-6 3-8-8 3-5-5-3 3 5 5z" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linejoin="round" />
            </svg>
          {% else %}
            <svg class="ts-service-icon" role="img" aria-hidden="true" viewBox="0 0 32 32">
              <circle cx="16" cy="16" r="10" fill="none" stroke="currentColor" stroke-width="1.7" />
              <path d="M12 16h8M16 12v8" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" />
            </svg>
          {% endcase %}
        {% endcapture %}

        {% include ts-service-card.html
          icon=service_icon
          title=service_title
          description=service_description
          tagline=service_tagline
          details=service_details
          url=service_url %}
      {% endfor %}
    </div>

    <nav class="ts-services__actions" aria-label="Service actions">
      <a class="btn btn--primary" href="/contact/">Book property upkeep</a>
      <a class="btn btn--ghost" href="/portfolio/">See recent projects</a>
    </nav>
  </div>
</section>